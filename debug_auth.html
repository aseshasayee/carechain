<!DOCTYPE html>
<html>
<head>
    <title>Debug Authentication</title>
</head>
<body>
    <h1>Debug Authentication</h1>
    <div id="output"></div>

    <script>
        const output = document.getElementById('output');
        
        // Check what's in localStorage
        const tokens = {
            'token': localStorage.getItem('token'),
            'access_token': localStorage.getItem('access_token'),
            'user': localStorage.getItem('user'),
            'userInfo': localStorage.getItem('userInfo'),
            'userType': localStorage.getItem('userType'),
            'userRole': localStorage.getItem('userRole'),
            'role': localStorage.getItem('role')
        };
        
        output.innerHTML = '<h2>LocalStorage Contents:</h2><pre>' + JSON.stringify(tokens, null, 2) + '</pre>';
        
        // Test API call
        async function testAPI() {
            try {
                const token = localStorage.getItem('token') || localStorage.getItem('access_token');
                const response = await fetch('http://localhost:8000/api/profiles/verified-profiles/', {
                    headers: {
                        'Authorization': token ? `Bearer ${token}` : '',
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = {
                    status: response.status,
                    statusText: response.statusText,
                    data: await response.text()
                };
                
                output.innerHTML += '<h2>API Test Result:</h2><pre>' + JSON.stringify(result, null, 2) + '</pre>';
            } catch (error) {
                output.innerHTML += '<h2>API Test Error:</h2><pre>' + error.message + '</pre>';
            }
        }
        
        // Add button to test API
        const button = document.createElement('button');
        button.textContent = 'Test API Call';
        button.onclick = testAPI;
        document.body.appendChild(button);
    </script>
</body>
</html>
